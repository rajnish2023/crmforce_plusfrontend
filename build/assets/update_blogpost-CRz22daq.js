import{w as U,k as $,r as h,j as e}from"./index-CNDwPbcK.js";import{E as K}from"./blogstyle-CPnEMUf1.js";import{e as z,b as H,h as O}from"./api-B9qGc84N.js";import{C as V}from"./CForm-CIYK7ixP.js";import{C as G,a as F}from"./CRow-C_mFcwcj.js";import{C as k}from"./CCard-B7_pa8np.js";import{C as P}from"./CCardHeader-BSbw5zxO.js";import{C as D}from"./CCardBody-ChFyFuQj.js";import{a as s,C as g,b as i}from"./CFormInput-D4b8rLgv.js";import{C as S}from"./CFormTextarea-pLeFGw-9.js";import{C as T}from"./CFormSelect-x_UCku4i.js";import{a as J}from"./CContainer-CCuO_NJc.js";const oe=()=>{const{id:x}=U(),B=$(),j="http://localhost:7878",[a,p]=h.useState({title:"",slug:"",excerpt:"",content:"",category:"",metaTitle:"",metaDescription:"",metakeywords:"",status:"Draft"}),[I,b]=h.useState([]),[n,y]=h.useState({}),[c,u]=h.useState({}),[C,N]=h.useState(null),[w,v]=h.useState(null),M=localStorage.getItem("token"),q=async()=>{try{const t=await z(x);p(t.data),t.data.banner&&N(t.data.banner),t.data.metaimage&&v(t.data.metaimage)}catch(t){console.error("Error fetching blog post:",t)}},R=async()=>{try{const t=await H();Array.isArray(t.data)?b(t.data):b([])}catch(t){console.error("Error fetching categories:",t)}};h.useEffect(()=>{R(),q()},[x]);const m=t=>{const{name:r,value:o}=t.target;p(l=>({...l,[r]:o})),y(l=>({...l,[r]:""}))},E=t=>{const{name:r,files:o}=t.target,l=o[0];if(p(d=>({...d,[r]:l})),l){const d=URL.createObjectURL(l);r==="banner"?N(d):r==="metaimage"&&v(d)}},A=t=>{p(r=>({...r,content:t}))},_=()=>{const t={};let r=!0;return a.title||(t.title="Title is required",r=!1),a.slug||(t.slug="Slug is required",r=!1),a.excerpt||(t.excerpt="Excerpt is required",r=!1),a.content||(t.content="Content is required",r=!1),a.category||(t.category="Category is required",r=!1),y(t),r},L=async t=>{if(t.preventDefault(),u({}),!_())return;const r=new FormData;r.append("title",a.title),r.append("slug",a.slug),r.append("excerpt",a.excerpt),r.append("content",a.content),r.append("category",a.category),r.append("author",a.author),r.append("metaTitle",a.metaTitle),r.append("metaDescription",a.metaDescription),r.append("metakeywords",a.metakeywords),r.append("status",a.status),a.banner&&r.append("banner",a.banner),a.metaimage&&r.append("metaimage",a.metaimage);try{const o=await O(M,x,r);B("/all-blogs")}catch(o){if(o.response&&o.response.data){const l=o.response.data.error||"An error occurred while updating the blog post",d=o.response.data.details||{};d.code===11e3&&d.keyPattern.slug?u(f=>({...f,slug:"This slug is already taken.",general:l})):u(f=>({...f,general:l}))}else u({general:"An unexpected error occurred"})}};return e.jsx(V,{onSubmit:L,children:e.jsxs(G,{className:"form-container",style:{padding:"20px"},children:[e.jsx(F,{xs:12,md:9,className:"mb-4",children:e.jsxs(k,{children:[e.jsx(P,{className:"bg-primary text-white",children:e.jsx("strong",{children:"Blog Details"})}),e.jsxs(D,{children:[e.jsx(s,{htmlFor:"title",className:"form-label",children:"Title"}),e.jsx(g,{id:"title",name:"title",value:a.title,onChange:m,placeholder:"Enter blog post title",className:"form-input"}),n.title&&e.jsx(i,{className:"text-danger",children:n.title}),c.title&&e.jsx(i,{className:"text-danger",children:c.title}),e.jsx(s,{htmlFor:"slug",className:"form-label",children:"Slug"}),e.jsx(g,{id:"slug",name:"slug",value:a.slug,onChange:m,placeholder:"Enter slug",className:"form-input"}),n.slug&&e.jsx(i,{className:"text-danger",children:n.slug}),c.slug&&e.jsx(i,{className:"text-danger",children:c.slug}),e.jsx(s,{htmlFor:"excerpt",className:"form-label",children:"Excerpt"}),e.jsx(S,{id:"excerpt",name:"excerpt",value:a.excerpt,onChange:m,placeholder:"Enter blog post excerpt",className:"form-textarea"}),n.excerpt&&e.jsx(i,{className:"text-danger",children:n.excerpt}),c.excerpt&&e.jsx(i,{className:"text-danger",children:c.excerpt}),e.jsx(s,{htmlFor:"banner",className:"form-label",children:"Banner"}),e.jsx(g,{id:"banner",name:"banner",type:"file",onChange:E,className:"form-file"}),C&&e.jsx("div",{className:"image-preview",style:{marginTop:"10px"},children:e.jsx("img",{src:`${j}/uploads/${C}`,alt:"Banner Preview",style:{width:"10%",height:"auto",borderRadius:"8px"}})}),e.jsx(s,{htmlFor:"content",className:"form-label",children:"Content"}),e.jsx(K,{apiKey:"swwi0ejh09qkjnay90r9f3n6dfuu54hxtzn3k3a27qrbb1d4",value:a.content,onEditorChange:A,init:{height:500,menubar:!0,plugins:["image","link","code","lists","table","fullscreen"],toolbar:"undo redo | bold italic | alignleft aligncenter alignright | image | link | h1 h2 h3 h4 h5 h6 | code | fullscreen",content_style:"h1,h2,h3,h4,h5,h6 { color: #000; }"}}),n.content&&e.jsx(i,{className:"text-danger",children:n.content}),c.content&&e.jsx(i,{className:"text-danger",children:c.content})]})]})}),e.jsx(F,{xs:12,md:3,className:"mb-4",children:e.jsxs(k,{children:[e.jsx(P,{className:"bg-secondary text-white",children:e.jsx("strong",{children:"Meta Information"})}),e.jsxs(D,{children:[e.jsx(s,{htmlFor:"category",className:"form-label",children:"Category"}),e.jsxs(T,{id:"category",name:"category",value:a.category?a.category._id:"",onChange:m,className:"form-select",children:[e.jsx("option",{value:"",children:"Select Category"}),I.map(t=>e.jsx("option",{value:t._id,children:t.title},t._id))]}),n.category&&e.jsx(i,{className:"text-danger",children:n.category}),e.jsx(s,{htmlFor:"metaimage",className:"form-label",children:"Meta Image"}),e.jsx(g,{id:"metaimage",name:"metaimage",type:"file",onChange:E,className:"form-file"}),w&&e.jsx("div",{className:"image-preview",style:{marginTop:"10px"},children:e.jsx("img",{src:`${j}/uploads/${w}`,alt:"Meta Image Preview",style:{width:"50%",height:"auto",borderRadius:"8px"}})}),e.jsx(s,{htmlFor:"metaTitle",className:"form-label",children:"Meta Title"}),e.jsx(g,{id:"metaTitle",name:"metaTitle",value:a.metaTitle,onChange:m,placeholder:"Enter meta title",className:"form-input"}),e.jsx(s,{htmlFor:"metaDescription",className:"form-label",children:"Meta Description"}),e.jsx(S,{id:"metaDescription",name:"metaDescription",value:a.metaDescription,onChange:m,placeholder:"Enter meta description",className:"form-textarea"}),e.jsx(s,{htmlFor:"metakeywords",className:"form-label",children:"Meta Keywords"}),e.jsx(g,{id:"metakeywords",name:"metakeywords",value:a.metakeywords,onChange:m,placeholder:"Enter meta keywords",className:"form-input"}),e.jsx(s,{htmlFor:"status",className:"form-label",children:"Status"}),e.jsxs(T,{id:"status",name:"status",value:a.status,onChange:m,className:"form-select",children:[e.jsx("option",{value:"Draft",children:"Draft"}),e.jsx("option",{value:"Published",children:"Published"})]}),e.jsx(J,{type:"submit",className:"btn btn-primary w-100",children:"Save Changes"})]})]})})]})})};export{oe as default};
