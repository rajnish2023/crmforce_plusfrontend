import{r as s,_ as S,R as U,b as k,c as F,P as c,j as e}from"./index-CNDwPbcK.js";import{a as v,c as G}from"./api-B9qGc84N.js";import{C as P}from"./index.esm-Dsfv9R7D.js";import{a as C}from"./CContainer-CCuO_NJc.js";import{C as T,a as $}from"./CRow-C_mFcwcj.js";import{C as O}from"./CCard-B7_pa8np.js";import{C as Z,a as _,b as B,c as V}from"./DefaultLayout-Bapu6jUF.js";import{C as z,a as H,b as q,c as J,d as K}from"./CModalTitle-hn51-tnD.js";import{C as Q}from"./CForm-CIYK7ixP.js";import{C as W}from"./CFormInput-D4b8rLgv.js";import"./cil-user-Dlmw-Gem.js";var x=s.forwardRef(function(l,g){var o=l.children,i=l.as,d=i===void 0?"img":i,m=l.className,n=l.orientation,f=S(l,["children","as","className","orientation"]);return U.createElement(d,k({className:F(n?"card-img-".concat(n):"card-img",m)},f,{ref:g}),o)});x.propTypes={as:c.elementType,children:c.node,className:c.string,orientation:c.oneOf(["top","bottom"])};x.displayName="CCardImage";var X=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M256,144a64,64,0,1,0-64-64A64.072,64.072,0,0,0,256,144Zm0-96a32,32,0,1,1-32,32A32.036,32.036,0,0,1,256,48Z' class='ci-primary'/><path fill='var(--ci-primary-color, currentColor)' d='M256,368a64,64,0,1,0,64,64A64.072,64.072,0,0,0,256,368Zm0,96a32,32,0,1,1,32-32A32.036,32.036,0,0,1,256,464Z' class='ci-primary'/><path fill='var(--ci-primary-color, currentColor)' d='M256,192a64,64,0,1,0,64,64A64.072,64.072,0,0,0,256,192Zm0,96a32,32,0,1,1,32-32A32.036,32.036,0,0,1,256,288Z' class='ci-primary'/>"];const Y=({className:l})=>{const[g,o]=s.useState(!1),[i,d]=s.useState(null),[m,n]=s.useState([]),[f,h]=s.useState(!1),[w,y]=s.useState([]),[N,b]=s.useState(!0),[p,D]=s.useState(null),j="http://localhost:7878";s.useEffect(()=>{(async()=>{try{const a=await v();y(a.data)}catch(a){console.error("Error fetching galleries:",a),D("Failed to load galleries")}finally{b(!1)}})()},[]);const I=r=>{navigator.clipboard.writeText(r),alert("Image link copied to clipboard")},L=r=>{const a=r.target.files;d(a);const t=Array.from(a).map(u=>URL.createObjectURL(u));n(t)},A=async()=>{if(i){const r=new FormData;Array.from(i).forEach(a=>r.append("files",a));try{await G(r),alert("Gallery uploaded successfully"),o(!1);const a=await v();y(a.data)}catch(a){alert("Error uploading gallery"),console.error("Error uploading gallery:",a)}}else alert("Please select images to upload.")},M=r=>{r.preventDefault(),h(!0)},R=()=>{h(!1)},E=r=>{r.preventDefault(),h(!1);const a=r.dataTransfer.files;d(a);const t=Array.from(a).map(u=>URL.createObjectURL(u));n(t)};return e.jsxs("div",{children:[e.jsx(C,{color:"primary",onClick:()=>o(!0),className:"mb-4",children:"Upload Gallery"}),p&&e.jsx("div",{className:"error-message",children:p}),e.jsx(T,{className:l,xs:{gutter:4},children:N?e.jsx("div",{children:"Loading galleries..."}):p?e.jsx("div",{className:"error-message",children:p}):w.map(r=>r.images.map((a,t)=>e.jsx($,{sm:6,xl:3,children:e.jsxs(O,{className:"mb-4 position-relative",children:[e.jsx(x,{orientation:"top",src:`${j}/uploads/${a}`,alt:`Image ${t+1}`}),e.jsx("div",{className:"d-flex justify-content-end position-absolute top-0 end-0 m-2",children:e.jsxs(Z,{children:[e.jsx(_,{color:"transparent",caret:!1,className:"text-black p-0",children:e.jsx(P,{icon:X})}),e.jsx(B,{children:e.jsx(V,{onClick:()=>I(`${j}/uploads/${a}`),children:"Copy Image Link"})})]})})]})},r._id+"-"+t)))}),e.jsxs(z,{visible:g,onClose:()=>o(!1),size:"lg",children:[e.jsx(H,{closeButton:!0,children:e.jsx(q,{children:"Upload Images"})}),e.jsx(J,{children:e.jsx(Q,{children:e.jsxs("div",{className:`file-upload-area ${f?"dragging":""}`,onDragOver:M,onDragLeave:R,onDrop:E,children:[e.jsx(W,{type:"file",multiple:!0,onChange:L,label:"Select Images or Drag and Drop",id:"image-upload",className:"file-input"}),m.length>0&&e.jsx("div",{className:"image-previews",children:m.map((r,a)=>e.jsx("img",{src:r,alt:`Preview ${a+1}`,className:"preview-image"},a))})]})})}),e.jsxs(K,{children:[e.jsx(C,{color:"secondary",onClick:()=>o(!1),children:"Cancel"}),e.jsx(C,{color:"primary",onClick:A,children:"Upload"})]})]})]})};Y.propTypes={className:c.string};export{Y as default};
